var _hmt=_hmt||[];(function(){function load(url){var hm=document.createElement('script');hm.src=url;var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(hm,s);};function loadBaiDu(key){load('http://hm.baidu.com/hm.js?'+key);};function run(){if(window['WXD_HELP_DATA']){if(WXD_HELP_DATA[11]){loadBaiDu('b916566977aeaa9d1e407f4325c2b05c');}else{loadBaiDu('f6e194783d20fbb234124a994651c922');};}else{loadBaiDu('f6e194783d20fbb234124a994651c922');};if(window.location.hostname=='u.weixiaodian.com'){loadBaiDu('d73d18f5b47b22be8c138c6daacac7dc');};};if(window['$']){$(window).on('load',run);$('[data-stats]').each(function(){var stats=$(this).attr('data-stats').split('-');var d={};$.each(stats,function(index,value){value=(value+'.').split('.');d[value[0]]=value[1];});if(d['event']){if(window['WXD_HELP_DATA']){if(!d['page']){d['page']=WXD_HELP_DATA[2].join('*');};};stats=[];$.each(d,function(key,value){stats.push(key+'.'+value);});$(this).on(d['event'],function(){$.ajax({url:'http://stats.weixiaodian.com/topic/',data:{data:stats.join('-')}});});};});}else{run();};})();;if(typeof JSON!=='object'){JSON={};};(function(){'use strict';function f(n){return n<10?'0'+n:n;};if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+f(this.getUTCMonth()+1)+'-'+f(this.getUTCDate())+'T'+f(this.getUTCHours())+':'+f(this.getUTCMinutes())+':'+f(this.getUTCSeconds())+'Z':null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf();};};var cx,escapable,gap,indent,meta,rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';};function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key);};if(typeof rep==='function'){value=rep.call(holder,key,value);};switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';};gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null';};v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v;};if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==='string'){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}};v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v;}};if(typeof JSON.stringify!=='function'){escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};JSON.stringify=function(value,replacer,space){var i;gap='';indent='';if(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' ';};}else if(typeof space==='string'){indent=space;};rep=replacer;if(replacer&&typeof replacer!=='function'&&(typeof replacer!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify');};return str('',{'':value});};};if(typeof JSON.parse!=='function'){cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}};return reviver.call(holder,key,value);};text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);});};if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j;};throw new SyntaxError('JSON.parse');};}}());;window['WXD']=window['WXD']||function(){};window['WXD']['UI']=window['WXD']['UI']||function(){};window['WXD']['Model']=window['WXD']['Model']||function(){};WXD_HELP_DATA=WXD_HELP_DATA||['','',['','',''],'',{},'',false];window['WXD']['PageData']=window['WXD']['PageData']||{username:WXD_HELP_DATA[0],sessionid:WXD_HELP_DATA[1],pagedata:{site:WXD_HELP_DATA[2][0],module:WXD_HELP_DATA[2][1],action:WXD_HELP_DATA[2][2]},time:WXD_HELP_DATA[3],timestamp:WXD_HELP_DATA[7],sitelist:WXD_HELP_DATA[4],source:WXD_HELP_DATA[5],debug:WXD_HELP_DATA[6]};(function(WXD){WXD.getguid=function(){var _guid='';for(var i=1;i<=32;i++){var n=Math.floor(Math.random()*16.0).toString(16);_guid+=n;if((i==8)||(i==12)||(i==16)||(i==20)){_guid+='-';};};return _guid;};WXD.crossDomain=function(){};WXD.crossDomain.$=null;WXD.crossDomain.q=[];WXD.crossDomain.is5=false;WXD.crossDomain.runing=true;WXD.crossDomain.run=function(q,crossDomain){if(q&&!crossDomain){for(var i=q.arguments.length;i<20;i++){q.arguments.push('');};try{WXD.Model[q.model][q.method](q.arguments[0],q.arguments[1],q.arguments[2],q.arguments[3],q.arguments[4],q.arguments[5],q.arguments[6],q.arguments[7],q.arguments[8],q.arguments[9]).then(function(a1,a2,a3,a4,a5,a6,a7,a8,a9){if(a1=='链接服务器失败。'){WXD.crossDomain.run(q,true);}else{q.callback(a1,a2,a3,a4,a5,a6,a7,a8,a9);};});}catch(err){WXD.crossDomain.run(q,true);};return;};if(!WXD.crossDomain.$){WXD.crossDomain.$=$('<iframe frameborder="0" style="height:30px;width:30px;position: absolute;top: -999px;"></iframe>').appendTo('body').on('load',function(){WXD.crossDomain.runing=false;WXD.crossDomain.run();}).on('error',function(){}).attr('src',WXD.PageData.sitelist['member']+'/account/crossdomain/'+((WXD_HELP_DATA[8]=='1')?'?touch=1':'')+'#'+encodeURIComponent('{"domin":"'+window.location.protocol+'//'+document.domain+((window.location.port)?':'+window.location.port:'')+'/'+'"}'));};if(q){WXD.crossDomain.q.push(q);};if(WXD.crossDomain.runing)return;if(WXD.crossDomain.q.length){WXD.crossDomain.runing=true;var data=WXD.crossDomain.q[0];WXD.crossDomain.q.shift();var id=WXD.getguid();var _setTimeout1,_setTimeout2;window['wxd_crossdomain_callback_'+id]=function(a1,a2,a3,a4,a5,a6,a7,a8,a9){clearTimeout(_setTimeout1);clearTimeout(_setTimeout2);data.callback(a1,a2,a3,a4,a5,a6,a7,a8,a9);window['wxd_crossdomain_callback_'+id]=null;};var css={'height':'50px','width':'50px'};if(WXD.crossDomain.is5){css={'height':'30px','width':'30px'};};WXD.crossDomain.is5=!WXD.crossDomain.is5;WXD.crossDomain.$.attr('src',WXD.crossDomain.$.attr('src').split('#')[0]+'#'+encodeURIComponent(JSON.stringify({id:id,callback:'wxd_crossdomain_callback_'+id,model:data.model,method:data.method,arguments:data.arguments}))).css(css);_setTimeout1=setTimeout(function(){css={'height':'50px','width':'50px'};if(WXD.crossDomain.is5){css={'height':'30px','width':'30px'};};WXD.crossDomain.is5=!WXD.crossDomain.is5;WXD.crossDomain.$.attr('src',WXD.crossDomain.$.attr('src').split('#')[0]+'#'+encodeURIComponent(JSON.stringify({id:id,callback:'wxd_crossdomain_callback_'+id,model:data.model,method:data.method,arguments:data.arguments}))).css(css);_setTimeout2=setTimeout(function(){css={'height':'50px','width':'50px'};if(WXD.crossDomain.is5){css={'height':'30px','width':'30px'};};WXD.crossDomain.is5=!WXD.crossDomain.is5;WXD.crossDomain.$.attr('src',WXD.crossDomain.$.attr('src').split('#')[0]+'#'+encodeURIComponent(JSON.stringify({id:id,callback:'wxd_crossdomain_callback_'+id,model:data.model,method:data.method,arguments:data.arguments}))).css(css);},500);},500);setTimeout(function(){WXD.crossDomain.runing=false;WXD.crossDomain.run();},1200);}};WXD.promise=function(fun){var self=this;self.queues=[];self.resolve=function(){var _arguments=arguments;setTimeout(function(){var fun=self.queues&&self.queues[0];if(fun){var ret=fun.apply(self,_arguments);self.queues.shift();if(ret){self.resolve.apply(self,ret);}};},10);return self;};self.then=function(fun){if(fun.constructor!==Function)return;self.queues.push(fun);return self;};if(fun)self.then(fun);};window['WXD']['Model'].base=function(){};window['WXD']['Model'].base.ajax=function(url,type,data,crossDomain){var promise=new WXD.promise();if(crossDomain){WXD.crossDomain.run({model:'base',method:'ajax',arguments:[url,type,data,false],callback:function(data){promise.resolve(data);}});}else{$.ajax({xhrFields:{withCredentials:true},url:url,type:type,dataType:'json',data:data,error:function(){promise.resolve("链接服务器失败。");},success:function(r){promise.resolve(r);}});};return promise;};})(WXD);;(function(WXD){function strlen(s){var l=0;var a=s.split('');for(var i=0;i<a.length;i++){if(a[i].charCodeAt(0)<299){l++;}else{l+=2;}}
return l;};WXD.Model.verify=function(){};WXD.Model.verify.phone=function(phone,asyn,crossDomain,data,url){var error=null;phone=$.trim(phone);if(asyn){var promise=new WXD.promise();if(crossDomain){WXD.crossDomain.run({model:'verify',method:'phone',arguments:[phone,asyn,false,data,url],callback:function(error,phone,data){promise.resolve(error,phone,data);}});}else{if(!/^\d{10,11}$/.test(phone)){setTimeout(function(){promise.resolve('手机号码格式错误！',phone,data);},10);}else{data=data||{};data['phone']=phone;$.ajax({xhrFields:{withCredentials:true},url:url||WXD.PageData.sitelist['member']+'/verify/phone',type:'post',dataType:'json',data:data,error:function(){promise.resolve('链接服务器失败。',phone,data);},success:function(r){promise.resolve((r.IsSuccess)?null:r.Message,phone,data);}});};};return promise;}else{if(/^\d{10,11}$/.test(phone)){return{error:null,phone:phone,data:data};}else{return{error:'手机号码格式错误！',phone:phone,data:data};}}};WXD.Model.verify.nickname=function(nickname,asyn,crossDomain,data,url){var error=null;nickname=$.trim(nickname);var length=strlen(nickname);if(asyn){var promise=new WXD.promise();if(crossDomain){WXD.crossDomain.run({model:'verify',method:'nickname',arguments:[nickname,asyn,false,data,url],callback:function(error,nickname,data){promise.resolve(error,nickname,data);}});}else{if(length<4||length>20){setTimeout(function(){promise.resolve('昵称格式错误，4-20个字符，只能由中英文、数字、"_"、"-"组成”',nickname,data);},10);}else{if(!/^[a-zA-Z0-9_\-\u4e00-\u9fa5]*$/.test(nickname)){setTimeout(function(){promise.resolve('昵称格式错误，4-20个字符，只能由中英文、数字、"_"、"-"组成”',nickname,data);},10);}else{data=data||{};data['nickname']=nickname;$.ajax({xhrFields:{withCredentials:true},url:url||WXD.PageData.sitelist['member']+'/verify/nickname',type:'post',dataType:'json',data:data,error:function(){promise.resolve('链接服务器失败。',nickname,data);},success:function(r){promise.resolve((r.IsSuccess)?null:r.Message,nickname,data);}});};};};return promise;}else{if(length<4||length>20){return{error:'昵称格式错误，4-20个字符，只能由中英文、数字、"_"、"-"组成”',nickname:nickname,data:data};}else{if(/^[a-zA-Z0-9_\-\u4e00-\u9fa5]*$/.test(nickname)){return{error:null,nickname:nickname,data:data};}else{return{error:'昵称格式错误，4-20个字符，只能由中英文、数字、"_"、"-"组成”',nickname:nickname,data:data};};};}};WXD.Model.verify.email=function(email,asyn,crossDomain,data,url){var error=null;email=$.trim(email);if(asyn){var promise=new WXD.promise();if(crossDomain){WXD.crossDomain.run({model:'verify',method:'email',arguments:[email,asyn,false,data,url],callback:function(error,email,data){promise.resolve(error,email,data);}});}else{if(!/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(email)){setTimeout(function(){promise.resolve('邮箱格式错误！',email,data);},10);}else{if(!/^.{4,30}$/.test(email)){setTimeout(function(){promise.resolve('邮箱长度只能在4-30位字符之间！',email,data);},10);return;}
data=data||{};data['email']=email;$.ajax({xhrFields:{withCredentials:true},url:url||WXD.PageData.sitelist['member']+'/verify/email',type:'post',dataType:'json',data:data,error:function(){promise.resolve('链接服务器失败。',email,data);},success:function(r){promise.resolve((r.IsSuccess)?null:r.Message,email,data);}});};};return promise;}else{if(/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(email)){if(!/^.{4,30}$/.test(email)){return{error:'邮箱长度只能在4-30位字符之间！',email:email,data:data};}
return{error:null,email:email,data:data};}else{return{error:'邮箱格式错误！',email:email,data:data};}}};WXD.Model.verify.idcard=function(idcard,asyn,crossDomain,data,url){var error=null;idcard=$.trim(idcard);if(asyn){var promise=new WXD.promise();if(crossDomain){WXD.crossDomain.run({model:'verify',method:'idcard',arguments:[idcard,asyn,false,data,url],callback:function(error,idcard,data){promise.resolve(error,idcard,data);}});}else{error=WXD.Model.verify.idcard._v(idcard);if(error!==true){setTimeout(function(){promise.resolve(error,idcard,data);},10);}else{data=data||{};data['idcard']=idcard;$.ajax({xhrFields:{withCredentials:true},url:url||WXD.PageData.sitelist['member']+'/verify/idcard',type:'post',dataType:'json',data:data,error:function(){promise.resolve('链接服务器失败。',idcard,data);},success:function(r){promise.resolve((r.IsSuccess)?null:r.Message,idcard,data);}});};};return promise;}else{error=WXD.Model.verify.idcard._v(idcard);return{error:(error!==true)?null:error,idcard:idcard,data:data};}};WXD.Model.verify.idcard._v=function(sId){var iSum=0;var info="";if(!/^\d{17}(\d|x)$/i.test(sId)){return"你输入的身份证长度或格式错误";};sId=sId.replace(/x$/i,"a");if(aCity[parseInt(sId.substr(0,2))]==null){return"你的身份证地区非法";};sBirthday=sId.substr(6,4)+"-"+Number(sId.substr(10,2))+"-"+Number(sId.substr(12,2));var d=new Date(sBirthday.replace(/-/g,"/"));if(sBirthday!=(d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate())){return"身份证上的出生日期非法";};for(var i=17;i>=0;i--){iSum+=(Math.pow(2,i)%11)*parseInt(sId.charAt(17-i),11);};if(iSum%11!=1){return"你输入的身份证号非法";};return true;};WXD.Model.verify.url=function(url){var error=null;url=$.trim(url);if(/^[a-zA-z]+:\/\/(\w+(-\w+)*)(\.(\w+(-\w+)*))*(\?\S*)?$/.test(url)){return{error:null,url:url};}else{return{error:'链接地址格式错误！',url:url};}};WXD.Model.verify.zipcode=function(zipcode,noEmpty){var error=null;zipcode=$.trim(zipcode);if(zipcode==''&&!noEmpty)return{error:null,zipcode:zipcode};if(/^\d{6}$/.test(zipcode)){return{error:null,zipcode:zipcode};}else{return{error:'邮政编码格式错误！',zipcode:zipcode};}};WXD.Model.verify.number=function(number){var error=null;number=$.trim(number);if(/^\d+$/.test(number)){return{error:null,number:number};}else{return{error:'格式错误！',number:number};}};WXD.Model.verify.password=function(password){var error=null;password=$.trim(password);if(password==''){error='密码不能为空';}else{if(!/^.{6,20}$/.test(password)){error='密码长度只能在6-20位字符之间';}else{if(/^((\d+)|([a-zA-Z]+)){1}$/.test(password)){error='密码太简单，请您更改密码，如字母+数字的组合';}}};return{error:error,password:password};};WXD.Model.verify.equal=function(value1,value2){var error=null;value1=$.trim(value1);value2=$.trim(value2);if(value1===value2){return{error:null,value2:value2,value1:value1};}else{return{error:true,value2:value2,value1:value1};}};WXD.Model.verify.imgcode=function(imgcode,asyn,crossDomain,data,url){var error=null;imgcode=$.trim(imgcode);if(asyn){var promise=new WXD.promise();if(crossDomain){WXD.crossDomain.run({model:'verify',method:'imgcode',arguments:[imgcode,asyn,false,data,url],callback:function(error,imgcode,data){promise.resolve(error,imgcode,data);}});}else{if(imgcode==''){setTimeout(function(){promise.resolve('请填写图文验证码',imgcode,data);},10);return promise;};if(!/^.{4}$/.test(imgcode)){setTimeout(function(){promise.resolve('图文验证码格式错误！',imgcode,data);},10);}else{data=data||{};data['imgcode']=imgcode;$.ajax({xhrFields:{withCredentials:true},url:url||WXD.PageData.sitelist['member']+'/verify/imgcode',type:'post',dataType:'json',data:data,error:function(){promise.resolve('链接服务器失败。',imgcode,data);},success:function(r){promise.resolve((r.IsSuccess)?null:r.Message,imgcode,data);}});};};return promise;}else{if(imgcode==''){return{error:'请填写图文验证码',imgcode:imgcode,data:data};};if(/^.{4}$/.test(imgcode)){return{error:null,imgcode:imgcode,data:data};}else{return{error:'图文验证码格式错误！',imgcode:imgcode,data:data};}}};WXD.Model.verify.phonecode=function(phone,phonecode,asyn,crossDomain,data,url){var error=null;phonecode=$.trim(phonecode);if(asyn){var promise=new WXD.promise();if(crossDomain){WXD.crossDomain.run({model:'verify',method:'phonecode',arguments:[phone,phonecode,asyn,false,data,url],callback:function(error,phonecode,data){promise.resolve(error,phonecode,data);}});}else{if(phonecode==''){setTimeout(function(){promise.resolve('请填写短信验证码',phonecode,data);},10);return promise;};if(!/^\d{6}$/.test(phonecode)){setTimeout(function(){promise.resolve('短信验证码格式错误！',phonecode,data);},10);}else{data=data||{};data['phone']=phone;data['phonecode']=phonecode;$.ajax({xhrFields:{withCredentials:true},url:url||WXD.PageData.sitelist['member']+'/verify/phonecode',type:'post',dataType:'json',data:data,error:function(){promise.resolve('链接服务器失败。',phonecode,data);},success:function(r){promise.resolve((r.IsSuccess)?null:r.Message,phonecode,data);}});};};return promise;}else{if(phonecode==''){return{error:'请填写短信验证码',phonecode:phonecode,data:data};};if(/^\d{6}$/.test(phonecode)){return{error:null,phonecode:phonecode,data:data};}else{return{error:'短信验证码格式错误！',phonecode:phonecode,data:data};}}};WXD.Model.verify.fullname=function(fullname){var error=null;fullname=$.trim(fullname);if(fullname==''){return{error:'请填写姓名！',fullname:fullname};};if(!/^[\u4e00-\u9fa5]+$/.test(fullname)){return{error:'请填写正确的姓名！',fullname:fullname};};if(fullname.length<2){return{error:'姓名长度不能少于2个字！',fullname:fullname};};if(fullname.length>10){return{error:'姓名长度不超过10个字！',fullname:fullname};};return{error:null,fullname:fullname};};WXD.Model.verify.address=function(address){var error=null;address=$.trim(address);if(address==''){return{error:'请填写详细的收货地址！',address:address};};if(address.length<5){return{error:'收货地址应该尽量详细，不小于5个字',address:address};}
if(address.length>50){return{error:'不需要重复填写省市区，不超过50个字',address:address};};return{error:null,address:address};};WXD.Model.verify.passwordStrength=function(password){var _r=checkPassword(password);if(_r<2){return 1;};if(_r>=4){return 3;};return 2;};function checkPassword(str){str=$.trim(str);var maths,smalls,bigs,corps,cat,num;var len=str.length;var cat=/.{20}/g;if(len==0)return 1;if(len>20){return 1;};cat=/.*[\u4e00-\u9fa5]+.*$/;if(cat.test(str)){return 1;};cat=/\d/;var maths=cat.test(str);cat=/[a-z]/;var smalls=cat.test(str);cat=/[A-Z]/;var bigs=cat.test(str);var corps=corpses(str);var num=maths+smalls+bigs+corps;if(len<6){return 1;};if(len>=6&&len<=8){if(num==1)return 1;if(num==2||num==3)return 2;if(num==4)return 3;};if(len>8&&len<=11){if(num==1)return 2;if(num==2)return 3;if(num==3)return 4;if(num==4)return 5;};if(len>11){if(num==1)return 3;if(num==2)return 4;if(num>2)return 5;};}
function corpses(str){var cat=/./g;var sz=str.match(cat);for(var i=0;i<sz.length;i++){cat=/\d/;maths_01=cat.test(sz[i]);cat=/[a-z]/;smalls_01=cat.test(sz[i]);cat=/[A-Z]/;bigs_01=cat.test(sz[i]);if(!maths_01&&!smalls_01&&!bigs_01){return true;};};return false;}})(WXD);;(function(WXD){WXD.Model.user=function(){};WXD.Model.user.on=function(event,fun){WXD.Model.user.events=WXD.Model.user.events||{};WXD.Model.user.events[event]=WXD.Model.user.events[event]||[];WXD.Model.user.events[event].push(fun);};WXD.Model.user.of=function(event,fun){WXD.Model.user.events=WXD.Model.user.events||{};if(fun){var length=(WXD.Model.user.events[event]=WXD.Model.user.events[event]||[]).length;for(var i=0;i<length;i++){if(_fun===WXD.Model.user.events[event][i]){WXD.Model.user.events[event].splice(i,1);i--;length--;}}}else{WXD.Model.user.events[event]=[];}};WXD.Model.user.bindphone=function(phone,phonecode,imgcode,password,crossDomain,data,url){var error=null;phone=$.trim(phone);var promise=new WXD.promise();if(crossDomain){WXD.crossDomain.run({model:'user',method:'bindphone',arguments:[phone,phonecode,imgcode,password,false,data,url],callback:function(error,phone,data){promise.resolve(error,phone,data);}});}else{var error=WXD.Model.verify.phone(phone,false,false,data).error;if(!error){error=WXD.Model.verify.phonecode(phone,phonecode,false,false,data).error;if(!error){error=WXD.Model.verify.imgcode(imgcode,false,false,data).error;};};if(error){setTimeout(function(){promise.resolve(error,phone,data);},10);}else{data=data||{};data['phone']=phone;data['phonecode']=phonecode;data['imgcode']=imgcode;data['password']=password;$.ajax({xhrFields:{withCredentials:true},url:url||WXD.PageData.sitelist['member']+'/verify/bindphone',type:'post',dataType:'json',data:data,error:function(){promise.resolve('链接服务器失败。',phone,phonecode,imgcode,data);},success:function(r){promise.resolve((r.IsSuccess)?null:r.Message,phone,phonecode,imgcode,data);}});};};return promise;};WXD.Model.user._sendphonecode=function(phone,imgcode,crossDomain,data,url){var error=null;phone=$.trim(phone);imgcode=$.trim(imgcode);var promise=new WXD.promise();if(crossDomain){WXD.crossDomain.run({model:'user',method:'_sendphonecode',arguments:[phone,imgcode,false,data,url],callback:function(error,phone,imgcode,data){promise.resolve(error,phone,imgcode,data);}});}else{var error=WXD.Model.verify.phone(phone,false,false,data).error;if(error){setTimeout(function(){promise.resolve(error,phone,imgcode,data);},10);}else{data=data||{};data['phone']=phone;data['imgcode']=imgcode;$.ajax({xhrFields:{withCredentials:true},url:url||WXD.PageData.sitelist['member']+'/verify/sendphonecode',type:'post',dataType:'json',data:data,error:function(){promise.resolve('链接服务器失败。',phone,imgcode,data);},success:function(r){if(!r.IsSuccess&&r.hasImgCode){var $box=null;var pcstyle='';if(!(window['WXD_HELP_DATA']&&WXD_HELP_DATA[11])){pcstyle='.m_sendphonecode_imgcode_bg{-moz-opacity:0.5;filter:alpha(opacity=50);}'+'.m_sendphonecode_imgcode{width:458px;font-size:24px;margin:-177px 0 0 -264px;padding:4px 35px 18px 35px;box-sizing: content-box;border-radius:10px;}'+'.m_sendphonecode_imgcode *{box-sizing: content-box;}'+'.m_sendphonecode_imgcode strong{line-height:96px;border-bottom:2px dashed #e6e6e6;font-size:30px;}'+'.m_sendphonecode_imgcode span{line-height:50px;color:#da251c;margin-top:-30px;display:none;}'+'.m_sendphonecode_imgcode a{line-height:88px;font-size:34px;border-radius:4px;}'+'.m_sendphonecode_imgcode p{margin:30px 0;}'+'.m_sendphonecode_imgcode input{height:70px;border:2px solid #e6e6e6;border-radius:4px;width:264px;font-size:60px;line-height:70px;padding:6px 0;}'+'.m_sendphonecode_imgcode img{height:86px;width:170px;margin-left:20px;}';};$box=$('<div>'+' <style>'+' .m_sendphonecode_imgcode_bg{position:fixed;top:0;left:0;right:0;bottom:0;z-index:999999;background:#000;opacity:.5;}'+' .m_sendphonecode_imgcode{width:5.28rem;font-size:.24rem;font-family:微软雅黑,yahei;position:fixed;left:50%;margin:-1.77rem 0 0 -2.64rem;padding:.04rem .35rem .18rem .35rem;background:#fff;box-sizing: border-box;border-radius:.1rem;top:50%;z-index:999999;}'+' .m_sendphonecode_imgcode *{box-sizing: border-box;}'+' .m_sendphonecode_imgcode strong{font-weight: normal;display:block;text-align:center;line-height:.96rem;border-bottom:.02rem dashed #e6e6e6;font-size:.3rem;}'+' .m_sendphonecode_imgcode span{display:block;line-height:.5rem;color:#da251c;margin-top:-.3rem;display:none;}'+' .m_sendphonecode_imgcode a{display:block;background:#da251c;line-height:.88rem;color:#fff;text-align:center;font-size:.34rem;text-decoration: none;border-radius:.04rem;}'+' .m_sendphonecode_imgcode p{margin:.3rem 0;padding:0;overflow:hidden;}'+' .m_sendphonecode_imgcode input{height:.86rem;border:.02rem solid #e6e6e6;border-radius:.04rem;width:2.68rem;font-size:.6rem;text-align:center;float:left;}'+' .m_sendphonecode_imgcode img{float:left;height:.86rem;width:1.7rem;margin-left:.2rem;}'+
pcstyle+' </style>'+' <div class="m_sendphonecode_imgcode_bg"></div>'+' <div class="m_sendphonecode_imgcode">'+'     <strong>请输入验证码</strong>'+'     <p>'+'         <input maxlength="4" type="text"/>'+'         <img data-src="'+WXD_HELP_DATA[4]['member']+'/chkcode-sendphonecode?@date"/>'+'     </p>'+'     <span></span>'+'     <a href="javascript:void(0);">确定</a>'+' </div>'+'</div>').appendTo('body');$box.children('div.m_sendphonecode_imgcode').fadeIn();var $error=$box.find('span');var verifying=false;$box.find('img').click(function(){$(this).attr('src',$(this).attr('data-src').replace(/@date/g,(new Date()).valueOf()));}).click();$box.children('div.m_sendphonecode_imgcode_bg').click(function(){$box.remove();promise.resolve('验证码发送失败',phone,imgcode,data);});$box.find('input').change(function(){$error.css('display','none');}).keyup(function(event){if(event.keyCode=='13'){$box.find('a').click();};});$box.find('a').click(function(){if(verifying)return;verifying=true;var imgcode=$.trim($box.find('input').val());$error.css('display','block').html('正在提交验证...');WXD.Model.verify.imgcode(imgcode,true,crossDomain,{type:'sendphonecode'}).then(function(error){if(error){verifying=false;$error.css('display','block').html(error);}else{$box.remove();data.type='sendphonecode';WXD.Model.user._sendphonecode(phone,imgcode,crossDomain,data,url).then(function(error,phone,imgcode,data){promise.resolve(error,phone,imgcode,data);});};});});return;};if(r.IsSuccess){if(window['Model']&&window['Model']['message']){window['Model']['message']('验证码已发送，请查看手机');};};promise.resolve((r.IsSuccess)?null:r.Message,phone,imgcode,data);}});};};return promise;};WXD.Model.user.sendphonecode=function(timecallback,time){var self=this;var _sending=false;var _setInterval=null;var _index=0;time=time||120;timecallback=timecallback||function(){};self.sending=function(){return _sending;};self.send=function(phone,imgcode,crossDomain,data,url){var promise=new WXD.promise();var __index=++_index;WXD.Model.user._sendphonecode(phone,imgcode,crossDomain,data,url).then(function(error,phone,data){if(__index!=_index)return;promise.resolve(error,phone,data);if(!error){var _time=time;_setInterval=setInterval(function(){timecallback(--_time);if(_time==0){clearInterval(_setInterval);_sending=false;}},1000);timecallback(_time);}});return promise;};self.cancel=function(){clearInterval(_setInterval);++_index;_sending=false;timecallback(0);};};WXD.Model.user._sendemailcode=function(email,crossDomain,data,url){var error=null;email=$.trim(email);var promise=new WXD.promise();if(crossDomain){WXD.crossDomain.run({model:'user',method:'_sendemailcode',arguments:[email,false,data,url],callback:function(error,email,data){promise.resolve(error,email,data);}});}else{var error=WXD.Model.verify.email(email,false,false,data).error;if(error){setTimeout(function(){promise.resolve(error,email,data);},10);}else{data=data||{};data['email']=email;$.ajax({xhrFields:{withCredentials:true},url:url||WXD.PageData.sitelist['member']+'/verify/sendemailcode',type:'post',dataType:'json',data:data,error:function(){promise.resolve('链接服务器失败。',email,data);},success:function(r){promise.resolve((r.IsSuccess)?null:r.Message,email,data);}});};};return promise;};WXD.Model.user.sendemailcode=function(timecallback,time){var self=this;var _sending=false;var _setInterval=null;var _index=0;time=time||120;timecallback=timecallback||function(){};self.sending=function(){return _sending;};self.send=function(email,crossDomain,data,url){var promise=new WXD.promise();var __index=++_index;WXD.Model.user._sendemailcode(email,crossDomain,data,url).then(function(error,email,data){if(__index!=_index)return;promise.resolve(error,email,data);if(!error){var _time=time;_setInterval=setInterval(function(){timecallback(--_time);if(_time==0){clearInterval(_setInterval);_sending=false;}},1000);timecallback(_time);}});return promise;};self.cancel=function(){clearInterval(_setInterval);++_index;_sending=false;timecallback(0);};};WXD.Model.user._sendemaillink=function(email,password,crossDomain,data,url){var error=null;email=$.trim(email);var promise=new WXD.promise();if(crossDomain){WXD.crossDomain.run({model:'user',method:'_sendemaillink',arguments:[email,password,false,data,url],callback:function(error,email,data){promise.resolve(error,email,data);}});}else{var error=WXD.Model.verify.email(email,false,false,data).error;if(error){setTimeout(function(){promise.resolve(error,email,data);},10);}else{data=data||{};data['email']=email;data['password']=password;$.ajax({xhrFields:{withCredentials:true},url:url||WXD.PageData.sitelist['member']+'/verify/sendemaillink',type:'post',dataType:'json',data:data,error:function(){promise.resolve('链接服务器失败。',email,data);},success:function(r){promise.resolve((r.IsSuccess)?null:r.Message,email,data);}});};};return promise;};WXD.Model.user.sendemaillink=function(timecallback,time){var self=this;var _sending=false;var _setInterval=null;var _index=0;time=time||120;timecallback=timecallback||function(){};self.sending=function(){return _sending;};self.send=function(email,password,crossDomain,data,url){var promise=new WXD.promise();var __index=++_index;WXD.Model.user._sendemaillink(email,password,crossDomain,data,url).then(function(error,email,data){if(__index!=_index)return;promise.resolve(error,email,data);if(!error){var _time=time;_setInterval=setInterval(function(){timecallback(--_time);if(_time==0){clearInterval(_setInterval);_sending=false;}},1000);timecallback(_time);}});return promise;};self.cancel=function(){clearInterval(_setInterval);++_index;_sending=false;timecallback(0);};};WXD.Model.user.login=function(username,password,imgcode,crossDomain,data,url){var error=null;username=$.trim(username||'');password=$.trim(password||'');imgcode=$.trim(imgcode||'');var promise=new WXD.promise();if(crossDomain){WXD.crossDomain.run({model:'user',method:'login',arguments:[username,password,imgcode,false,data,url],callback:function(error,ShowCode,userData,data){promise.resolve(error,ShowCode,userData,data);}});}else{if(username!=''){if(password==''){setTimeout(function(){promise.resolve('密码不能为空。',WXD.Model.user.login.ShowCode,null,data);},10);return promise;}}else{setTimeout(function(){promise.resolve('用户名不能为空。',WXD.Model.user.login.ShowCode,null,data);},10);return promise;};if(imgcode){error=WXD.Model.verify.imgcode(imgcode).error;if(error){setTimeout(function(){promise.resolve(error,WXD.Model.user.login.ShowCode,null,data);},10);return promise;}}
data=data||{};data['username']=username;data['imgcode']=imgcode;data['password']=password;$.ajax({xhrFields:{withCredentials:true},url:url||WXD.PageData.sitelist['member']+'/verify/login',type:'post',dataType:'json',data:data,error:function(){promise.resolve('链接服务器失败。',WXD.Model.user.login.ShowCode,null,data);},success:function(r){WXD.Model.user.login.ShowCode=r.ShowCode;if(r.IsSuccess){$.each(r.runlist||[],function(index,url){$('<img src="'+url+'"/>').hide().appendTo('body');});setTimeout(function(){if(r.goto){window.location.href=r.goto;return;};WXD.Model.user.events=WXD.Model.user.events||{};WXD.Model.user.events['logined']=WXD.Model.user.events['logined']||[];$.each(WXD.Model.user.events['logined'],function(index,fun){fun(userData);});promise.resolve(null,WXD.Model.user.login.ShowCode,r.userData,data);},500);}else{promise.resolve((r.IsSuccess)?null:r.Message,WXD.Model.user.login.ShowCode,r.userData,data);}}});};return promise;};WXD.Model.user.register=function(username,password,imgcode,phonecode,crossDomain,data,url){var error=null;username=$.trim(username||'');password=$.trim(password||'');imgcode=$.trim(imgcode||'');phonecode=$.trim(phonecode||'');var promise=new WXD.promise();if(crossDomain){WXD.crossDomain.run({model:'user',method:'register',arguments:[username,password,imgcode,phonecode,false,data,url],callback:function(error,userData,data){promise.resolve(error,userData,data);}});}else{error=WXD.Model.verify.phone(username).error;if(error){error=WXD.Model.verify.email(username).error;if(error){setTimeout(function(){promise.resolve(error,null,data);},10);return promise;};error=WXD.Model.verify.imgcode(imgcode).error;if(error){setTimeout(function(){promise.resolve(error,null,data);},10);return promise;};}else{error=WXD.Model.verify.phonecode(username,phonecode).error;if(error){setTimeout(function(){promise.resolve(error,null,data);},10);return promise;};};error=WXD.Model.verify.password(password).error;if(error){setTimeout(function(){promise.resolve(error,null,data);},10);return promise;};data=data||{};data['username']=username;data['password']=password;data['imgcode']=imgcode;data['phonecode']=phonecode;$.ajax({xhrFields:{withCredentials:true},url:url||WXD.PageData.sitelist['member']+'/verify/register',type:'post',dataType:'json',data:data,error:function(){promise.resolve('链接服务器失败。',null,data);},success:function(r){if(r.IsSuccess){$.each(r.runlist||[],function(index,url){$('<img src="'+url+'"/>').hide().appendTo('body');});setTimeout(function(){if(r.goto){window.location.href=r.goto;return;};WXD.Model.user.events=WXD.Model.user.events||{};WXD.Model.user.events['registered']=WXD.Model.user.events['registered']||[];$.each(WXD.Model.user.events['registered'],function(index,fun){fun(userData);});WXD.Model.user.events['logined']=WXD.Model.user.events['logined']||[];$.each(WXD.Model.user.events['logined'],function(index,fun){fun(userData);});promise.resolve(null,r.userData,data);},500);}else{promise.resolve((r.IsSuccess)?null:r.Message,r.userData,data);}}});};return promise;};WXD.Model.user.checklogin=function(crossDomain,data,url){var promise=new WXD.promise();if(crossDomain){WXD.crossDomain.run({model:'user',method:'checklogin',arguments:[false,data,url],callback:function(error,userData,data){promise.resolve(error,userData,data);}});}else{data=data||{};$.ajax({xhrFields:{withCredentials:true},url:url||WXD.PageData.sitelist['member']+'/verify/checklogin',type:'post',dataType:'json',data:data,error:function(){promise.resolve('链接服务器失败。',null,data);},success:function(r){promise.resolve((r.IsSuccess)?null:r.Message,r.userData,data);}});};return promise;};})(WXD);;(function($){var Queue=[];function loadimg(isimg,src,$element,srcProperty,outtime){try{var $img=$('<img/>').load(load).error(load);function load(){clearTimeout(_setTimeout);$img.unbind('load error');$img.remove();if(isimg){$element.attr('src',src).removeAttr(srcProperty);if($element.next().length&&$element.next()[0].nodeName.toUpperCase()=='DFN'){$element.parent().css({'background-image':'none'});};if($element.css('display')!='none'){$element.hide().stop(true,true).fadeIn();};}else{$element.css('background-image','url('+src+')').removeAttr(srcProperty);if($element.css('display')!='none'){$element.hide().stop(true,true).fadeIn();};};};var _setTimeout=setTimeout(load,outtime);$img.appendTo('body').hide().attr('src',src);}
catch(ex){if(isimg){$element.attr('src',src).removeAttr(srcProperty);if($element.next().length&&$element.next()[0].nodeName.toUpperCase()=='DFN'){$element.parent().css({'background-image':'none'});};}else{$element.css('background-image','url('+src+')').removeAttr(srcProperty);};};};function _run(lazyloadData){var length=0;if(length=lazyloadData.elements.length){var top=0;var left=0;var scrollTop=$(lazyloadData.settings.container).scrollTop()-lazyloadData.settings.threshold;var scrollLeft=$(lazyloadData.settings.container).scrollLeft()-lazyloadData.settings.threshold;var containerHeight=$(lazyloadData.settings.container).height()+lazyloadData.settings.threshold*2;var containerWidth=$(lazyloadData.settings.container).width()+lazyloadData.settings.threshold*2;if(lazyloadData.settings.container!==window){top=$(lazyloadData.settings.container).offset().top;left=$(lazyloadData.settings.container).offset().left;};for(var i=0;i<length;){var _top=lazyloadData.elements[i].offset().top-top;var _height=lazyloadData.elements[i].height();var _left=lazyloadData.elements[i].offset().left-left;var _width=lazyloadData.elements[i].width();if(_top>scrollTop+containerHeight){if(lazyloadData.settings.absolute){if(lazyloadData.settings.mode==='Row'){i+=lazyloadData.settings.rowItemNum;}else{i++;};}else{i=length;};}else if(_top+_height<scrollTop){if(lazyloadData.settings.mode==='Row'){i+=lazyloadData.settings.rowItemNum;}else{i++;};}else{length--;var _count=1;if(lazyloadData.settings.mode==='Row'){_count=lazyloadData.settings.rowItemNum;};while(_count--){var src=lazyloadData.elements[i].attr(lazyloadData.settings.srcProperty);var type=lazyloadData.elements[i][0].nodeName.toUpperCase();if(src){loadimg(type==='IMG',src,lazyloadData.elements[i],lazyloadData.settings.srcProperty,lazyloadData.settings.outTime);}else if(type!=='IMG'){lazyloadData.elements[i].find('['+lazyloadData.settings.srcProperty+']').each(function(){loadimg($(this)[0].nodeName.toUpperCase()==='IMG',$(this).attr(lazyloadData.settings.srcProperty),$(this),lazyloadData.settings.srcProperty,lazyloadData.settings.outTime);});};lazyloadData.elements.splice(i,1);}}};};};function windowscrollrun(lazyloadData){if(lazyloadData){_run(lazyloadData);}else{for(var i=Queue.length-1;i>=0;i--){if(Queue[i].elements.length){_run(Queue[i]);}else{Queue.splice(i,1);};};}};function windowscroll(){var _setTimeout=null;$(window).scroll(function(event){clearTimeout(_setTimeout);_setTimeout=setTimeout(function(){windowscrollrun();},100);});windowscroll=function(){};};$.fn.lazyload=function(options){var self=this;var settings={mode:'Single',itemSelecter:'>*',rowItemNum:1,threshold:0,container:window,outTime:5000,srcProperty:'truesrc',absolute:false};if(options){$.extend(settings,options);};var elements=[];if(settings.mode==='Row'){$(self).find(settings.itemSelecter).each(function(){elements.push($(this));});}else{$(self).each(function(){elements.push($(this));});};if(settings.container!==window){var _setTimeout=null;$(settings.container).scroll(function(){clearTimeout(_setTimeout);_setTimeout=setTimeout(function(){windowscrollrun({settings:settings,elements:elements});},100);});windowscrollrun({settings:settings,elements:elements});}else{Queue.push({settings:settings,elements:elements});windowscrollrun(Queue[Queue.length-1]);};windowscroll();return this;};})(jQuery);;(function($){$.fn.slide=function(stop){$.each($(this),function(){if(!$(this).hasClass('m_jquery_slide')){return;};var time,type,auto,index,oldindex,_setTimeout;time=$(this).attr('data-time')||'3000';type=$(this).attr('data-type')||'left';auto=$(this).attr('data-auto')!='false';index=$(this).attr('data-index')||'0';if(!/^\d+$/.test(time))time='3000';if(!/^\d+$/.test(index))index='0';index=parseInt(index);time=parseInt(time);var $content=$(this).children('.content');var $items=$content.children();var $indexs=$(this).children('.index').children('a');var $next=$(this).children('.next');var $prev=$(this).children('.prev');var runing=false;if(index+1>$items.length)oldindex=index=0;function autorun(){if(runing)return;clearTimeout(_setTimeout);_setTimeout=setTimeout(function(){oldindex=index;if(++index>=$items.length)index=0;run();},time);};function loadimg(){var $item=$items.eq(index);$item.find('[data-src]').each(function(){$(this).attr('src',$(this).attr('data-src')).removeAttr('data-src');});if($item.attr('data-src')){$item.css('background-image','url('+$item.attr('data-src')+')').removeAttr('data-src');};$item.find('[data-bgsrc]').each(function(){$(this).css('background-image','url('+$(this).attr('data-bgsrc')+')').removeAttr('data-bgsrc');});if($item.attr('data-bgsrc')){$item.css('background-image','url('+$item.attr('data-bgsrc')+')').removeAttr('data-bgsrc');}};loadimg();if($items.length<=1)return;function run(){runing=true;$indexs.removeClass('selected').eq(index).addClass('selected');$items.addClass('hidden').eq(index).css('z-index',2).removeClass('hidden').end().eq(oldindex).removeClass('hidden').css('z-index',1);switch(type){case'top':if(index>oldindex){$items.eq(index).css({'top':'100%'}).animate({'top':0},{duration:400,queue:false});$items.eq(oldindex).css({'top':0}).animate({'top':'-100%'},{duration:400,queue:false,complete:function(){runing=false;$items.eq(oldindex).addClass('hidden');if(auto){autorun();}}});}else{$items.eq(index).css({'top':'-100%'}).animate({'top':0},{duration:400,queue:false});$items.eq(oldindex).css({'top':0}).animate({'top':'100%'},{duration:400,queue:false,complete:function(){runing=false;$items.eq(oldindex).addClass('hidden');if(auto){autorun();}}});};break;case'left':if(index>oldindex){$items.eq(index).css({'left':'100%'}).animate({'left':0},{duration:400,queue:false});$items.eq(oldindex).css({'left':0}).animate({'left':'-100%'},{duration:400,queue:false,complete:function(){runing=false;$items.eq(oldindex).addClass('hidden');if(auto){autorun();}}});}else{$items.eq(index).css({'left':'-100%'}).animate({'left':0},{duration:400,queue:false});$items.eq(oldindex).css({'left':0}).animate({'left':'100%'},{duration:400,queue:false,complete:function(){runing=false;$items.eq(oldindex).addClass('hidden');if(auto){autorun();}}});};break;default:$items.eq(index).css({'opacity':0}).animate({'opacity':1},{duration:400,queue:false});$items.eq(oldindex).css({'opacity':1}).animate({'opacity':0},{duration:400,queue:false,complete:function(){runing=false;$items.eq(oldindex).addClass('hidden');if(auto){autorun();}}});break;};loadimg();};$indexs.removeClass('selected').eq(index).addClass('selected');$items.addClass('hidden').eq(index).removeClass('hidden');$indexs.mouseenter(function(event){if(runing)return;var _index=$indexs.index(this);if(_index>=$items.length)return;oldindex=index;index=_index;if(oldindex==index)return;run();});$prev.click(function(){if(runing)return;oldindex=index;if(--index<0)index=$items.length-1;run();});$next.click(function(){if(runing)return;oldindex=index;if(++index>=$items.length)index=0;run();});if(auto){autorun();$(this).mousemove(function(event){clearTimeout(_setTimeout);}).mouseleave(function(event){autorun();});};});return this;};})(jQuery);;$(document).ready(function(){$('#js_news').on('mouseenter','>span',function(event){$('#js_news').nextAll().addClass('hidden').eq($(this).addClass('selected').siblings('span.selected').removeClass('selected').end().index()).removeClass('hidden');});$('#js_p_guide').on('mouseenter','a',function(event){$('#js_p_guide').nextAll().addClass('hidden').eq($(this).addClass('selected').siblings('a.selected').removeClass('selected').end().index()).removeClass('hidden').find('img[data-src]').each(function(){$(this).attr('src',$(this).attr('data-src')).removeAttr('data-src');});});$('#js_p_guide_cids').on('mouseenter','a',function(event){$('#js_p_guide_cids').nextAll().addClass('hidden').eq($(this).addClass('selected').parent().siblings().find('a.selected').removeClass('selected').end().end().index()).removeClass('hidden');});$('#js_p_guide_cids').nextAll().addClass('hidden');setTimeout(function(){$('#js_p_guide_cids').find('a:first').mouseenter();},10);$('.m_jquery_slide').slide();$('[truesrc]').lazyload();if($('#js_login_box').length){(function(){var $username=$('#js_username');var $usernameErrorTip=$username.nextAll('.error');var $password=$('#js_password');var $passwordErrorTip=$password.nextAll('.error');var $code=$('#js_code');var $codeErrorTip=$code.nextAll('.error');$code.next().click(function(){$(this).attr('src',$(this).attr('data-src')+'?'+WXD.getguid());});var $codebox=$code.parent();var $login=$('#js_login');var $loginErrorTip=$login.nextAll('.error');$username.focus(function(event){$loginErrorTip.html('');$usernameErrorTip.html('');}).blur(function(event){if(!$.trim($username.val())){$usernameErrorTip.html('用户名不能为空。');}});$password.focus(function(event){$loginErrorTip.html('');$passwordErrorTip.html('');}).blur(function(event){if(!$.trim($password.val())){$passwordErrorTip.html('密码不能为空。');}});var codeindex=0;$code.focus(function(event){++codeindex;$loginErrorTip.html('');$codeErrorTip.html('');}).blur(function(event){if(_showcode){var _codeindex=++codeindex;WXD.Model.verify.imgcode($code.val(),true,false,{type:'login'},'/verify/imgcode').then(function(error){if(error&&_codeindex==codeindex){$codeErrorTip.html(error);}});}});$('#js_login_box').on('keydown','input',function(event){if(event.keyCode=='13'){$login.click();};});var loging=false;var _showcode=false;$login.click(function(){if(loging)return;$usernameErrorTip.html('');$passwordErrorTip.html('');$codeErrorTip.html('');$loginErrorTip.html('');loging=true;WXD.Model.user.login($username.val(),$password.val(),$code.val(),false,{},'/admin-index/login').then(function(error,showcode,userdata){loging=false;_showcode=showcode;if(showcode){$codebox.show();$code.next().attr('src',$code.next().attr('data-src')+'?'+WXD.getguid());}else{$codebox.hide();$code.val('');}
$login.prop('disabled',false).val('登录');if(error){$loginErrorTip.html(error);}else{window.location.reload();}});$login.prop('disabled',true).val('正在登录...');});})();};});